"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.replacerWithPath = void 0;
function replacerWithPath(replacer) {
    const pathMap = new WeakMap();
    return function (key, value) {
        var _a;
        const pathPrevious = (_a = pathMap.get(this)) !== null && _a !== void 0 ? _a : [];
        const path = [...pathPrevious];
        if (key !== '') {
            const pathEntry = !Array.isArray(this) ? key : parseInt(key, 10);
            path.push(pathEntry);
        }
        if (isIterable(value))
            pathMap.set(value, path);
        return replacer.call(this, key, value, path);
    };
}
exports.replacerWithPath = replacerWithPath;
function isIterable(value) {
    return value === Object(value);
}
